
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Visiting a State Machine with an Actor &#8212; Netzob Documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fuzzing Message Format" href="fuzzing.html" />
    <link rel="prev" title="Sending and Receiving Messages" href="trafficgeneration.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/zoby.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Netzob Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Netzob documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../installation/python.html">
   Installation of Netzob
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Protocol Modelization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dataspec.html">
   Format Message Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="statemachinespec.html">
   State Machine Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="protospec.html">
   Protocol Modeling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Traffic Generation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="trafficgeneration.html">
   Sending and Receiving Messages
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Visiting a State Machine with an Actor
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fuzzing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fuzzing.html">
   Fuzzing Message Format
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="fuzzing_automata.html">
   Fuzzing Automata
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/language_specification/actor.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Visiting a State Machine with an Actor</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="visiting-a-state-machine-with-an-actor">
<span id="actor"></span><h1>Visiting a State Machine with an Actor<a class="headerlink" href="#visiting-a-state-machine-with-an-actor" title="Permalink to this headline">#</a></h1>
<p>An <strong>actor</strong> (see <a class="reference internal" href="#netzob.Simulator.Actor.Actor" title="netzob.Simulator.Actor.Actor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Actor</span></code></a>) is a high-level representation of an entity that participates in a communication. An actor communicates with remote peers, in respect to an automaton (an actor is in fact a visitor of an automaton), and exchanges abstract representation of messages called Symbols.</p>
<p>In the API, a visitor of a state machine is modeled using the Actor
class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Actor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">automata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata" title="netzob.Model.Grammar.Automata.Automata"><span class="pre">Automata</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dataspec.html#netzob.Model.Vocabulary.Types.AbstractType.AbstractType" title="netzob.Model.Vocabulary.Types.AbstractType.AbstractType"><span class="pre">AbstractType</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">initiator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Actor'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor" title="Permalink to this definition">#</a></dt>
<dd><p>An actor is a component which, given a automaton and a list of
symbols, can visit the automaton, and generate and parse messages
in respect to the states and transitions.</p>
<p>An actor is implemented as a Python thread. An actor should be
launched with the <a class="reference internal" href="#netzob.Simulator.Actor.Actor.start" title="netzob.Simulator.Actor.Actor.start"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start</span></code></a> method. When an actor starts, it
automatically visits the associated automaton, and exchanges
symbols with a remote peer. This capability to automatically
travel the automaton is called the <strong>visit loop</strong>.</p>
<p>Without any special directive, the visit loop will stop if it
reaches one of the terminal states of the automaton.</p>
<p>It is possible to stop the visit loop using the
<a class="reference internal" href="#netzob.Simulator.Actor.Actor.stop" title="netzob.Simulator.Actor.Actor.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a> method. An actor always stops its visit loop at a
state, and never during a transition. This means that when calling
the <a class="reference internal" href="#netzob.Simulator.Actor.Actor.stop" title="netzob.Simulator.Actor.Actor.stop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">stop</span></code></a> method, if the actor is currently executing a
transition, it will finish the transition and will reach the
ending state of the transition.</p>
<p>It is also possible to define exit conditions where the actor
exits the visit loop if specific conditions are met. Currently available exit conditions are
<code class="xref py py-attr docutils literal notranslate"><span class="pre">nbMaxTransitions</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">target_state</span></code> (see explanation below).</p>
<p>When an actor either reaches an exit condition, a terminal state, or is forced to
stop the visit loop, we then get manual control over the visit of
the automaton. For example, we can indicate to execute the next
transition through the <a class="reference internal" href="#netzob.Simulator.Actor.Actor.execute_transition" title="netzob.Simulator.Actor.Actor.execute_transition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">execute_transition</span></code></a> method.</p>
<p>The Actor constructor expects some parameters:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>automata</strong> (<a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata" title="netzob.Model.Grammar.Automata.Automata"><code class="xref py py-class docutils literal notranslate"><span class="pre">Automata</span></code></a>,
required) – This parameter is the automaton the actor will visit.</p></li>
<li><p><strong>channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractChannel</span></code>, required) – This parameter is the underlying communication channel.</p></li>
<li><p><strong>initiator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – This parameter, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, indicates that the actor initiates the
communication and emits the input symbol.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, indicates that the actor is waiting for another
peer to initiate the connection. Default value is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of the actor. Default value is ‘Actor’.</p></li>
</ul>
</dd>
</dl>
<p>The Actor class provides the following public variables:</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>automata</strong> (<a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata" title="netzob.Model.Grammar.Automata.Automata"><code class="xref py py-class docutils literal notranslate"><span class="pre">Automata</span></code></a>) – The automaton the actor will visit.</p></li>
<li><p><strong>channel</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractChannel</span></code>) – The underlying communication channel.</p></li>
<li><p><strong>name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The name of the actor.</p></li>
<li><p><strong>fuzzing_presets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="dataspec.html#netzob.Model.Vocabulary.Preset.Preset" title="netzob.Model.Vocabulary.Preset.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>) – A list of preset configurations, used for fuzzing purpose at
specific states (see <code class="docutils literal notranslate"><span class="pre">fuzzing_states</span></code> attribute), only when sending symbols.
Values in this fuzzing configuration will
override any field definition, constraints or
relationship dependencies. See <a class="reference internal" href="dataspec.html#netzob.Model.Vocabulary.Preset.Preset" title="netzob.Model.Vocabulary.Preset.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>
for a complete explanation of its usage for fuzzing purpose.</p></li>
<li><p><strong>fuzzing_states</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.States.State.State" title="netzob.Model.Grammar.States.State.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>) – A list of states on which format message
fuzzing is applied.</p></li>
<li><p><strong>memory</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Memory</span></code>) – A memory context used to store variable values during specialization
and abstraction of successive symbols. This context is notably used to handle
inter-symbol relationships and relationships with the environment.</p></li>
<li><p><strong>presets</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="dataspec.html#netzob.Model.Vocabulary.Preset.Preset" title="netzob.Model.Vocabulary.Preset.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of preset configurations used during specialization and abstraction of symbols emitted and received by the actor. Values
in this configuration will override any field
definition, constraints or relationship dependencies. See
<a class="reference internal" href="dataspec.html#netzob.Model.Vocabulary.Preset.Preset" title="netzob.Model.Vocabulary.Preset.Preset"><code class="xref py py-class docutils literal notranslate"><span class="pre">Preset</span></code></a>
for a complete explanation of its usage.</p></li>
<li><p><strong>cbk_select_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code>) – A callback used to tell if the current actor is concerned by the data received on the communication channel.</p></li>
<li><p><strong>current_state</strong> (<a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.States.State.State" title="netzob.Model.Grammar.States.State.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>) – The current state of the actor.</p></li>
<li><p><strong>target_state</strong> (<a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.States.State.State" title="netzob.Model.Grammar.States.State.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>) – A state at which position the actor will exit the visit loop. This is an exit condition of the visit loop. <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default value) means no targeted state.</p></li>
<li><p><strong>nbMaxTransitions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The maximum number of transitions the actor will visit. This is an exit condition of the visit loop. <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default value) means no limit.</p></li>
</ul>
</dd>
</dl>
<p><strong>Callback prototype</strong></p>
<p>A callback function can be used to tell if the current actor is concerned by the received data on the communication channel. The callback function that can be used in the
<code class="docutils literal notranslate"><span class="pre">cbk_select_data</span></code> parameter has the following prototype:</p>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">cbk_select_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bytes</span></code>) – contains the current data received on the communication channel.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The callback function should return a <code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>
telling if the current actor is concerned by the
received data (should be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> in such case).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<p><strong>Actor methods</strong></p>
<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#netzob.Simulator.Actor.Actor.start" title="Permalink to this definition">#</a></dt>
<dd><p>Start the thread’s activity.</p>
<p>It must be called at most once per thread object. It arranges for the
object’s run() method to be invoked in a separate thread of control.</p>
<p>This method will raise a RuntimeError if called more than once on the
same thread object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor.stop" title="Permalink to this definition">#</a></dt>
<dd><p>Stop the visit loop of the automaton.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.wait">
<span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor.wait"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor.wait" title="Permalink to this definition">#</a></dt>
<dd><p>Wait for the current actor to finish the visit loop of the automaton.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.execute_transition">
<span class="sig-name descname"><span class="pre">execute_transition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor.execute_transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor.execute_transition" title="Permalink to this definition">#</a></dt>
<dd><p>Execute the next transition in the automaton.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A boolean telling if the transition execution triggered an exit condition of the visit loop of the automaton. Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if an exit condition is triggered.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.isActive">
<span class="sig-name descname"><span class="pre">isActive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor.isActive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor.isActive" title="Permalink to this definition">#</a></dt>
<dd><p>Indicate if the current actor is active (i.e. if the automaton
visit is still processing).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the actor has not finished.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="netzob.Simulator.Actor.Actor.generateLog">
<span class="sig-name descname"><span class="pre">generateLog</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Simulator/Actor.html#Actor.generateLog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Simulator.Actor.Actor.generateLog" title="Permalink to this definition">#</a></dt>
<dd><p>Return the log of the transitions and states visited by the actor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An string containing the visit log.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
</dl>
</dd></dl>

<p><strong>List of actor examples</strong></p>
<p>Several illustrations of actor usages are provided below:</p>
<ul class="simple">
<li><p>Common automaton for a client and a server (see <a class="reference internal" href="#actorexample1">ActorExample1</a>).</p></li>
<li><p>Dedicated automaton for a client and a server (see <a class="reference internal" href="#actorexample2">ActorExample2</a>).</p></li>
<li><p>Modification of the emitted symbol by a client through a callback (see <a class="reference internal" href="#actorexample3">ActorExample3</a>).</p></li>
<li><p>Modification of the emitted symbol by a server through a callback (see <a class="reference internal" href="#actorexample4">ActorExample4</a>).</p></li>
<li><p>Modification of the current transition by a client through a callback (see <a class="reference internal" href="#actorexample5">ActorExample5</a>).</p></li>
<li><p>Modification of the current transition of a server through a callback (see <a class="reference internal" href="#actorexample6">ActorExample6</a>).</p></li>
<li><p>Transition with no input symbol (see <a class="reference internal" href="#actorexample7">ActorExample7</a>).</p></li>
<li><p>How to catch all read symbol timeout (see <a class="reference internal" href="#actorexample8">ActorExample8</a>).</p></li>
<li><p>How to catch all receptions of unexpected symbols (see <a class="reference internal" href="#actorexample9">ActorExample9</a>).</p></li>
<li><p>How to catch all receptions of unknown messages (see <a class="reference internal" href="#actorexample10">ActorExample10</a>).</p></li>
<li><p>Message format fuzzing from an actor (see <a class="reference internal" href="#actorexample11">ActorExample11</a>).</p></li>
<li><p>Message format fuzzing from an actor, at a specific state (see <a class="reference internal" href="#actorexample12">ActorExample12</a>).</p></li>
<li><p>Several actors on the same communication channel (see <a class="reference internal" href="#actorexample13">ActorExample13</a>).</p></li>
</ul>
<p id="actorexample1"><strong>Common automaton for a client and a server</strong></p>
<p>For instance, we can create two very simple network Actors which
communicate together through a TCP channel and exchange their
names until one stops.</p>
<p>The two actors are Alice and Bob. Bob is the initiator of the
communication. This means that Bob is the first actor to
communicate with the remote peer, and Alice is listening for
incoming messages. Bob sends an input symbol containing the string
“bob&gt;hello”. Alice is waiting for this input symbol. When Alice
receives this input symbol, she responds with an output symbol
containing the string “alice&gt;hello”. Bob is then waiting for this
output symbol.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Conf</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bobSymbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob-Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;bob&gt;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aliceSymbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice-Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;alice&gt;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">aliceSymbol</span><span class="p">,</span> <span class="n">bobSymbol</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">inputSymbol</span><span class="o">=</span><span class="n">bobSymbol</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">aliceSymbol</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   hello (Bob-Hello;{Alice-Hello})</span>
<span class="go">|                         | ----------------------------------+</span>
<span class="go">|           S1            |                                   |</span>
<span class="go">|                         | &lt;---------------------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create actors: Alice (a server) and Bob (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#time.sleep(1)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;hello&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;hello&#39;, sending input symbol (&#39;Bob-Hello&#39;)</span>
<span class="go">  [+]   During transition &#39;hello&#39;, receiving expected output symbol (&#39;Alice-Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;hello&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;hello&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;hello&#39;, sending input symbol (&#39;Bob-Hello&#39;)</span>
<span class="go">  [+]   During transition &#39;hello&#39;, receiving expected output symbol (&#39;Alice-Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;hello&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Bob-Hello&#39; corresponds to transition &#39;hello&#39;</span>
<span class="go">  [+]   During transition &#39;hello&#39;, choosing an output symbol (&#39;Alice-Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;hello&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Bob-Hello&#39; corresponds to transition &#39;hello&#39;</span>
<span class="go">  [+]   During transition &#39;hello&#39;, choosing an output symbol (&#39;Alice-Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;hello&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample2"><strong>Dedicated automaton for a client and a server</strong></p>
<p>The two actors are Alice and Bob. Bob is the initiator of the
communication, meaning he sends the input symbols while Alice
answers with its output symbols. The automaton here is
very simple, and different for each actor. We first open the
channel, and allow Bob to send the data <code class="docutils literal notranslate"><span class="pre">&quot;hello&quot;</span></code> multiple
times. Alice answers every time with the data <code class="docutils literal notranslate"><span class="pre">&quot;hello&quot;</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_firstTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_secondTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Hello;{Hello})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T2 (Hello;{Hello})</span>
<span class="go">|                         | ---------------------+</span>
<span class="go">|           S2            |                      |</span>
<span class="go">|                         | &lt;--------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T1 (Hello;{Hello})</span>
<span class="go">|                         | ---------------------+</span>
<span class="go">|           S1            |                      |</span>
<span class="go">|                         | &lt;--------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample3"><strong>Modification of the emitted symbol by a client through a callback</strong></p>
<p>The following example shows how to modify the symbol that is sent
by the client to the server, through a callback method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that returns a new transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifySymbol</span><span class="p">(</span><span class="n">available_symbols</span><span class="p">,</span> <span class="n">current_symbol</span><span class="p">,</span> <span class="n">current_preset</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">last_received_symbol</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">last_received_symbol_name</span> <span class="o">=</span> <span class="n">last_received_symbol</span><span class="o">.</span><span class="n">name</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">last_received_symbol_name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">... </span>   <span class="n">preset</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">current_symbol</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c1"># Building the output symbol by incrementing the value of the last</span>
<span class="gp">... </span>   <span class="c1"># received symbol</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">last_received_symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">last_received_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">field_data</span> <span class="o">=</span> <span class="n">last_received_structure</span><span class="p">[</span><span class="n">last_received_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="gp">... </span>       <span class="n">field_data_int</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field_data</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">field_data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">field_data_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">preset</span><span class="p">[</span><span class="n">current_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field_data</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">preset</span><span class="p">[</span><span class="n">current_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x02</span><span class="s1">&#39;</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c1"># Sending current symbol with specific preset</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="p">(</span><span class="n">current_symbol</span><span class="p">,</span> <span class="n">preset</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="n">nbBytes</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;main transition&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the callback on the main transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span><span class="o">.</span><span class="n">add_cbk_modify_symbol</span><span class="p">(</span><span class="n">cbk_modifySymbol</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#========================#</span>
<span class="go">H           S0           H</span>
<span class="go">#========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------+   main transition (Symbol;{Symbol}) [CBK modify symbol]</span>
<span class="go">|                        | --------------------------------------------------------+</span>
<span class="go">|           S1           |                                                         |</span>
<span class="go">|                        | &lt;-------------------------------------------------------+</span>
<span class="go">+------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s3</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s3</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">endState</span><span class="o">=</span><span class="n">alice_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S4            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;main transition&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, modifying input symbol to &#39;Symbol&#39;, through callback</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;main transition&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;main transition&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, modifying input symbol to &#39;Symbol&#39;, through callback</span>
<span class="go">  [+]   During transition &#39;main transition&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;main transition&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T2&#39;</span>
<span class="go">  [+]   During transition &#39;T2&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Close&#39;</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
</pre></div>
</div>
<p id="actorexample4"><strong>Modification of the emitted symbol by a server through a callback</strong></p>
<p>The following example shows how to modify the symbol that is sent
by the server in response to a client request, through a callback
method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that returns a new symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifySymbol</span><span class="p">(</span><span class="n">available_symbols</span><span class="p">,</span> <span class="n">current_symbol</span><span class="p">,</span> <span class="n">current_preset</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">last_received_symbol</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">last_received_symbol_name</span> <span class="o">=</span> <span class="n">last_received_symbol</span><span class="o">.</span><span class="n">name</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">last_received_symbol_name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">... </span>   <span class="n">preset</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">current_symbol</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c1"># Building the output symbol by incrementing the value of the last received symbol</span>
<span class="gp">... </span>   <span class="k">if</span> <span class="n">last_received_symbol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">last_received_message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">field_data</span> <span class="o">=</span> <span class="n">last_received_structure</span><span class="p">[</span><span class="n">last_received_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="gp">... </span>       <span class="n">field_data_int</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">field_data</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">field_data</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">field_data_int</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">preset</span><span class="p">[</span><span class="n">current_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field_data</span>
<span class="gp">... </span>   <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>       <span class="n">preset</span><span class="p">[</span><span class="n">current_symbol</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x02</span><span class="s1">&#39;</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c1"># Sending current symbol with specific preset</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="p">(</span><span class="n">current_symbol</span><span class="p">,</span> <span class="n">preset</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="n">nbBytes</span><span class="o">=</span><span class="mi">1</span><span class="p">))],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;symbol1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">))],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;symbol2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (symbol2;{symbol1})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (symbol2;{symbol1})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S4            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the callback on the main transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span><span class="o">.</span><span class="n">add_cbk_modify_symbol</span><span class="p">(</span><span class="n">cbk_modifySymbol</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#========================#</span>
<span class="go">H           S0           H</span>
<span class="go">#========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------+   T1 (symbol1;{symbol1}) [CBK modify symbol]</span>
<span class="go">|                        | ---------------------------------------------+</span>
<span class="go">|           S1           |                                              |</span>
<span class="go">|                        | &lt;--------------------------------------------+</span>
<span class="go">+------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span> 
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;symbol2&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;symbol1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;symbol2&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;symbol1&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span> 
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;symbol1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;symbol1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, modifying output symbol to &#39;symbol1&#39;, through callback</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;symbol1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;symbol1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, modifying output symbol to &#39;symbol1&#39;, through callback</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample5"><strong>Modification of the current transition by a client through a callback</strong></p>
<p>The following example shows how to modify the current transition
of a client in its automaton, through a callback method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Conf</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that returns a new transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifyTransition</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">,</span> <span class="n">nextTransition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Modify the selected transition</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">nextTransition</span> <span class="ow">in</span> <span class="n">availableTransitions</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">availableTransitions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nextTransition</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">nextTransition</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">nextTransition</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="n">nbBytes</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition3</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_transition4</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                             <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the callback on the main states</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#============================#</span>
<span class="go">H             S0             H</span>
<span class="go">#============================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T1 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S1 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T3 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S2 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T4 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S3             |</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S4             |</span>
<span class="go">+----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="n">symbolList</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#============================#</span>
<span class="go">H             S0             H</span>
<span class="go">#============================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T1 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S1 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T3 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S2 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T4 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S3             |</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S4             |</span>
<span class="go">+----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   Changing transition to &#39;T2&#39; (initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T3&#39; (initiator)</span>
<span class="go">  [+]   Changing transition to &#39;T4&#39; (initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T4&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T4&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T4&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample6"><strong>Modification of the current transition of a server through a callback</strong></p>
<p>The following example shows how to modify the current transition
of a server in its automaton, through a callback method.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Conf</span><span class="o">.</span><span class="n">apply</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that returns a new transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifyTransition</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">,</span> <span class="n">nextTransition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Modify the selected transition so that we change the next state</span>
<span class="gp">... </span>    <span class="n">initialTransition</span> <span class="o">=</span> <span class="n">nextTransition</span>
<span class="gp">... </span>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">break</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">nextTransition</span><span class="o">.</span><span class="n">endState</span> <span class="o">!=</span> <span class="n">current_state</span> <span class="ow">and</span> <span class="n">initialTransition</span> <span class="o">!=</span> <span class="n">nextTransition</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">break</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">nextTransition</span> <span class="ow">in</span> <span class="n">availableTransitions</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">availableTransitions</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">nextTransition</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">break</span>
<span class="gp">... </span>        <span class="n">nextTransition</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">nextTransition</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="n">Raw</span><span class="p">(</span><span class="n">nbBytes</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span><span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="n">symbolList</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#========================#</span>
<span class="go">H           S0           H</span>
<span class="go">#========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------+   T1 (Symbol;{Symbol})</span>
<span class="go">|                        | -----------------------+</span>
<span class="go">|           S1           |                        |</span>
<span class="go">|                        | &lt;----------------------+</span>
<span class="go">+------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition3</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition4</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span>  <span class="n">endState</span><span class="o">=</span><span class="n">alice_s3</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                              <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s3</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Apply the callback on the main states, which is the main state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#============================#</span>
<span class="go">H             S0             H</span>
<span class="go">#============================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T1 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S1 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+   T3 (Symbol;{Symbol})</span>
<span class="go">|                            | -----------------------+</span>
<span class="go">| S2 [CBK modify transition] |                        |</span>
<span class="go">|                            | &lt;----------------------+</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T4 (Symbol;{Symbol})</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S3             |</span>
<span class="go">+----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------+</span>
<span class="go">|             S4             |</span>
<span class="go">+----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T2&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T2&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol&#39; corresponds to transition &#39;T3&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T4&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T4&#39;, choosing an output symbol (&#39;Symbol&#39;)</span>
<span class="go">  [+]   Transition &#39;T4&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Close&#39;</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
</pre></div>
</div>
<p id="actorexample7"><strong>Transition with no input symbol</strong></p>
<p>The following example shows how to specify no input symbol, for
both a sender (Bob) and a receiver (Alice), at the state <code class="docutils literal notranslate"><span class="pre">S1</span></code>.
This example makes it possible to automatically transit to the next state <code class="docutils literal notranslate"><span class="pre">S2</span></code>.
Thus, Bob does not need to send a message (using
<code class="xref py py-attr docutils literal notranslate"><span class="pre">inputSymbol</span></code>)
in transition between <code class="docutils literal notranslate"><span class="pre">S2</span></code> and <code class="docutils literal notranslate"><span class="pre">S3</span></code> to expect a message from Alice.</p>
<p>This sequence temporarily puts Bob in receiving mode only, until this
transition is active.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First, we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">helloAlice</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;HelloAlice&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello alice&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">helloBob</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;HelloBob&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello bob&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bye</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bye&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;bye&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bobSymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">helloAlice</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aliceSymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">helloBob</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">allSymbols</span> <span class="o">=</span> <span class="n">bobSymbols</span> <span class="o">+</span> <span class="n">aliceSymbols</span> <span class="o">+</span> <span class="p">[</span><span class="n">bye</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topen</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">bob_s2</span><span class="p">,</span> <span class="n">inputSymbol</span><span class="o">=</span><span class="n">helloAlice</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">helloBob</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">bob_s3</span><span class="p">,</span> <span class="n">inputSymbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">bye</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tclose</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">bob_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">allSymbols</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=============================#</span>
<span class="go">H             S0              H</span>
<span class="go">#=============================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-----------------------------+</span>
<span class="go">|             S1              |</span>
<span class="go">+-----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (HelloAlice;{HelloBob})</span>
<span class="go">  v</span>
<span class="go">+-----------------------------+</span>
<span class="go">|             S2              |</span>
<span class="go">+-----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T2 (Empty Symbol;{Bye})</span>
<span class="go">  v</span>
<span class="go">+-----------------------------+</span>
<span class="go">|             S3              |</span>
<span class="go">+-----------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-----------------------------+</span>
<span class="go">|             S4              |</span>
<span class="go">+-----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Alice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">alice_s2</span><span class="p">,</span> <span class="n">inputSymbol</span><span class="o">=</span><span class="n">helloAlice</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">helloBob</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">alice_s3</span><span class="p">,</span> <span class="n">inputSymbol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">bye</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bye&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span><span class="o">.</span><span class="n">outputSymbolsReactionTime</span> <span class="o">=</span> <span class="p">{</span><span class="n">bye</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">alice_s3</span><span class="p">,</span> <span class="n">alice_s4</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">allSymbols</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#================================#</span>
<span class="go">H               S0               H</span>
<span class="go">#================================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+--------------------------------+</span>
<span class="go">|               S1               |</span>
<span class="go">+--------------------------------+</span>
<span class="go">  |</span>
<span class="go">  | Hello (HelloAlice;{HelloBob})</span>
<span class="go">  v</span>
<span class="go">+--------------------------------+</span>
<span class="go">|               S2               |</span>
<span class="go">+--------------------------------+</span>
<span class="go">  |</span>
<span class="go">  | Bye (Empty Symbol;{Bye})</span>
<span class="go">  v</span>
<span class="go">+--------------------------------+</span>
<span class="go">|               S3               |</span>
<span class="go">+--------------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+--------------------------------+</span>
<span class="go">|               S4               |</span>
<span class="go">+--------------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create actors: Alice (a UDP server) and Bob (a UDP client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Alice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">3.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;HelloAlice&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;HelloBob&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;Empty Symbol&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;Bye&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;HelloAlice&#39; corresponds to transition &#39;Hello&#39;</span>
<span class="go">  [+]   During transition &#39;Hello&#39;, choosing an output symbol (&#39;HelloBob&#39;)</span>
<span class="go">  [+]   Transition &#39;Hello&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Receiving no symbol (EmptySymbol) corresponds to transition &#39;Bye&#39;</span>
<span class="go">  [+]   During transition &#39;Bye&#39;, choosing an output symbol (&#39;Bye&#39;)</span>
<span class="go">  [+]   Transition &#39;Bye&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Close&#39;</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S4&#39;</span>
<span class="go">  [+] At state &#39;S4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
</pre></div>
</div>
<p id="actorexample8"><strong>How to catch all read symbol timeout</strong></p>
<p>The following example shows how to specify a global behavior, on
all states and transitions, in order to catch timeouts when
listening for symbols. In this example, we set a callback through the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_cbk_read_symbol_timeout()</span></code>. when a timeout occurs on
reception of a symbol, the defined callback will move the current
position in the state machine to a specific state called
‘error_state’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create a symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Start state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mainTransition</span><span class="o">.</span><span class="n">outputSymbolsReactionTime</span> <span class="o">=</span> <span class="p">{</span><span class="n">symbol</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">closeTransition1</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">error_state</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close with error&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">closeTransition2</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_method</span><span class="p">(</span><span class="n">current_state</span><span class="p">,</span> <span class="n">current_transition</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">error_state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span><span class="o">.</span><span class="n">set_cbk_read_symbol_timeout</span><span class="p">(</span><span class="n">cbk_method</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H       Start state       H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T1 (Hello;{Hello})</span>
<span class="go">|                         | ---------------------+</span>
<span class="go">|           S1            |                      |</span>
<span class="go">|                         | &lt;--------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|       Close state       |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create actors: Alice (a server) and Bob (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;Start state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, timeout in reception triggered a callback that lead to state &#39;Error state&#39;</span>
<span class="go">  [+] At state &#39;Error state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close with error&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close with error&#39; lead to state &#39;Close state&#39;</span>
<span class="go">  [+] At state &#39;Close state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;Start state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample9"><strong>How to catch all receptions of unexpected symbols</strong></p>
<p>The following example shows how to specify a global behavior, on
all states and transitions, in order to catch reception of unexpected symbols (i.e. symbols that are known but not expected at this state/transition). In this example, we set a callback through the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_cbk_read_unexpected_symbol()</span></code>. When an unexpected symbol is received, the defined callback will move the current
position in the state machine to a specific state called ‘error_state’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello1&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello1&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello2&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_error_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition1</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_error_state</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition2</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_method</span><span class="p">(</span><span class="n">current_state</span><span class="p">,</span> <span class="n">current_transition</span><span class="p">,</span> <span class="n">received_symbol</span><span class="p">,</span> <span class="n">received_message</span><span class="p">,</span> <span class="n">received_structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">bob_error_state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span><span class="o">.</span><span class="n">set_cbk_read_unexpected_symbol</span><span class="p">(</span><span class="n">cbk_method</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Hello1;{Hello2})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T1 (Hello1;{Hello1})</span>
<span class="go">|                         | -----------------------+</span>
<span class="go">|           S1            |                        |</span>
<span class="go">|                         | &lt;----------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Hello1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving unexpected symbol triggered a callback that lead to state &#39;Error state&#39;</span>
<span class="go">  [+] At state &#39;Error state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample10"><strong>How to catch all receptions of unknown messages</strong></p>
<p>The following example shows how to specify a global behavior, on
all states and transitions, in order to catch reception of unknown messages (i.e. messages that cannot be abstracted to a symbol). In this example, we set a callback through the method <code class="xref py py-meth docutils literal notranslate"><span class="pre">set_cbk_read_unknown_symbol()</span></code>. When an unknown message is received, the defined callback will move the current
position in the state machine to a specific state called
‘error_state’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello1&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello1&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello2&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_error_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition1</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_error_state</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition2</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_method</span><span class="p">(</span><span class="n">current_state</span><span class="p">,</span> <span class="n">current_transition</span><span class="p">,</span> <span class="n">received_message</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">bob_error_state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span><span class="o">.</span><span class="n">set_cbk_read_unknown_symbol</span><span class="p">(</span><span class="n">cbk_method</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Hello1;{Hello1})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T1 (Hello1;{Hello2})</span>
<span class="go">|                         | -----------------------+</span>
<span class="go">|           S1            |                        |</span>
<span class="go">|                         | &lt;----------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Hello1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving unknown symbol triggered a callback that lead to state &#39;Error state&#39;</span>
<span class="go">  [+] At state &#39;Error state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello2&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample11"><strong>Message format fuzzing from an actor</strong></p>
<p>This example shows the creation of a fuzzing actor, Bob, that will
exchange messages with a Target, Alice. Messages generated from
‘Symbol 1’ will be specifically fuzzed, but not those generated from
‘Symbol 2’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">uint8</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Symbol 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">uint8</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">)))],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Symbol 2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_firstTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_secondTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#====================================#</span>
<span class="go">H                 S0                 H</span>
<span class="go">#====================================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------------------+</span>
<span class="go">|                 S1                 |</span>
<span class="go">+------------------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Symbol 1;{Symbol 1,Symbol 2})</span>
<span class="go">  v</span>
<span class="go">+------------------------------------+   T2 (Symbol 2;{Symbol 1,Symbol 2})</span>
<span class="go">|                                    | ------------------------------------+</span>
<span class="go">|                 S2                 |                                     |</span>
<span class="go">|                                    | &lt;-----------------------------------+</span>
<span class="go">+------------------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that always returns alice_transition2 to handle reception of fuzzed messages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifyTransition</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">,</span> <span class="n">nextTransition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">nextTransition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">alice_transition2</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">nextTransition</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">                               #============================#</span>
<span class="go">                               H             S0             H</span>
<span class="go">                               #============================#</span>
<span class="go">                                 |</span>
<span class="go">                                 | OpenChannelTransition</span>
<span class="go">                                 v</span>
<span class="go">    T2 (Symbol 2;{Symbol 2})   +----------------------------+   T1 (Symbol 1;{Symbol 1})</span>
<span class="go">  +--------------------------- |                            | ---------------------------+</span>
<span class="go">  |                            | S1 [CBK modify transition] |                            |</span>
<span class="go">  +--------------------------&gt; |                            | &lt;--------------------------+</span>
<span class="go">                               +----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define fuzzing configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">symbol1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span><span class="o">.</span><span class="n">fuzz</span><span class="p">(</span><span class="n">symbol1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">fuzzing_presets</span> <span class="o">=</span> <span class="p">[</span><span class="n">preset_symbol1</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol 1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, fuzzing activated</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Unknown message b&#39;\x00&#39;&#39; corresponds to transition &#39;None&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T2&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T2&#39;, choosing an output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol 2&#39; corresponds to transition &#39;T2&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T2&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T2&#39;, choosing an output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample12"><strong>Message format fuzzing from an actor, at a specific state</strong></p>
<p>This example shows the creation of a fuzzing actor, Bob, that will
exchange messages with a Target, Alice. Only messages sent at a
specific state, S2, will be fuzzed.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">uint8</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Symbol 1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">uint8</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">)))],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Symbol 2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_firstTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                 <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                 <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_secondTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#====================================#</span>
<span class="go">H                 S0                 H</span>
<span class="go">#====================================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------------------+</span>
<span class="go">|                 S1                 |</span>
<span class="go">+------------------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Symbol 1;{Symbol 1,Symbol 2})</span>
<span class="go">  v</span>
<span class="go">+------------------------------------+   T2 (Symbol 2;{Symbol 1,Symbol 2})</span>
<span class="go">|                                    | ------------------------------------+</span>
<span class="go">|                 S2                 |                                     |</span>
<span class="go">|                                    | &lt;-----------------------------------+</span>
<span class="go">+------------------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that always returns alice_transition2 to handle reception of fuzzed messages</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifyTransition</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">,</span> <span class="n">nextTransition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">nextTransition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">alice_transition2</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">nextTransition</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="s1">&#39;S1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">                               #============================#</span>
<span class="go">                               H             S0             H</span>
<span class="go">                               #============================#</span>
<span class="go">                                 |</span>
<span class="go">                                 | OpenChannelTransition</span>
<span class="go">                                 v</span>
<span class="go">    T2 (Symbol 2;{Symbol 2})   +----------------------------+   T1 (Symbol 1;{Symbol 1})</span>
<span class="go">  +--------------------------- |                            | ---------------------------+</span>
<span class="go">  |                            | S1 [CBK modify transition] |                            |</span>
<span class="go">  +--------------------------&gt; |                            | &lt;--------------------------+</span>
<span class="go">                               +----------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define fuzzing configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">symbol1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span><span class="o">.</span><span class="n">fuzz</span><span class="p">(</span><span class="n">symbol1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol2</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">symbol2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol2</span><span class="o">.</span><span class="n">fuzz</span><span class="p">(</span><span class="n">symbol2</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">fuzzing_presets</span> <span class="o">=</span> <span class="p">[</span><span class="n">preset_symbol1</span><span class="p">,</span> <span class="n">preset_symbol2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">fuzzing_states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;S2&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Symbol 1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving expected output symbol (&#39;Symbol 1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, sending input symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   During transition &#39;T2&#39;, fuzzing activated</span>
<span class="go">  [+]   During transition &#39;T2&#39;, receiving expected output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S2&#39;</span>
<span class="go">  [+] At state &#39;S2&#39;, we reached the max number of transitions (3), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Symbol 1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Symbol 1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Unknown message b&#39;\x00&#39;&#39; corresponds to transition &#39;None&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T2&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T2&#39;, choosing an output symbol (&#39;Symbol 2&#39;)</span>
<span class="go">  [+]   Transition &#39;T2&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p id="actorexample13"><strong>Several actors on the same communication channel</strong></p>
<p>The following example shows the capability to create several
actors that share the same underlying communication channel. In
order for the communication channel to retrieve the actor
concerned by received packets, a <code class="xref py py-attr docutils literal notranslate"><span class="pre">cbk_select_data</span></code> callback
is used.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bobSymbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob-Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;bob&gt;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aliceSymbol</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice-Hello&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;alice&gt;hello&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">aliceSymbol</span><span class="p">,</span> <span class="n">bobSymbol</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">inputSymbol</span><span class="o">=</span><span class="n">bobSymbol</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">aliceSymbol</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hello&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   hello (Bob-Hello;{Alice-Hello})</span>
<span class="go">|                         | ----------------------------------+</span>
<span class="go">|           S1            |                                   |</span>
<span class="go">|                         | &lt;---------------------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_select_data_bob</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">data</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;alice&gt;&quot;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">True</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_select_data_alice</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">data</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;bob&gt;&quot;</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">True</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="kc">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create actors: Alice (a server) and Bob (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">IPChannel</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Alice&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">cbk_select_data</span> <span class="o">=</span> <span class="n">cbk_select_data_alice</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">initiator</span> <span class="o">=</span> <span class="kc">False</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Bob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">cbk_select_data</span> <span class="o">=</span> <span class="n">cbk_select_data_bob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">3</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">channel</span><span class="o">.</span><span class="n">isActive</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">bob</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="trafficgeneration.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Sending and Receiving Messages</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="fuzzing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Fuzzing Message Format</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2011-2022, Frédéric Guihéry, Georges Bossert.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>