
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Fuzzing Automata &#8212; Netzob Documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Fuzzing Message Format" href="fuzzing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/zoby.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Netzob Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Netzob documentation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Installation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../installation/python.html">
   Installation of Netzob
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Protocol Modelization
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dataspec.html">
   Format Message Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="statemachinespec.html">
   State Machine Modeling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="protospec.html">
   Protocol Modeling
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Traffic Generation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="trafficgeneration.html">
   Sending and Receiving Messages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="actor.html">
   Visiting a State Machine with an Actor
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fuzzing
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="fuzzing.html">
   Fuzzing Message Format
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Fuzzing Automata
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/language_specification/fuzzing_automata.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Fuzzing Automata</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="fuzzing-automata">
<span id="id1"></span><h1>Fuzzing Automata<a class="headerlink" href="#fuzzing-automata" title="Permalink to this headline">#</a></h1>
<p>Mutation of a protocol state machine is provided by the <code class="xref py py-meth docutils literal notranslate"><span class="pre">mutate()</span></code> method of the <a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata" title="netzob.Model.Grammar.Automata.Automata"><code class="xref py py-class docutils literal notranslate"><span class="pre">Automata</span></code></a> class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="netzob.Model.Grammar.Automata.Automata.mutate">
<span class="sig-prename descclassname"><span class="pre">Automata.</span></span><span class="sig-name descname"><span class="pre">mutate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/netzob/Model/Grammar/Automata.html#Automata.mutate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#netzob.Model.Grammar.Automata.Automata.mutate" title="Permalink to this definition">#</a></dt>
<dd><p>This is the mutation method of the automaton. This method returns
a new automaton that may be used for fuzzing purpose.</p>
<p>The mutate method expects some parameters:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strategy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AutomataMutatorStrategy</span></code>, optional) – <p>The strategy used to build the new automaton.</p>
<p>The following strategies are available:</p>
<ul>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.RANDOM</span></code>: Randomly insert and remove transitions between states of the original automaton,</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.FULL</span></code>: At each state of the automaton, it is possible to reach any states,</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.ONESTATE</span></code>: Build an automaton with one main state that accepts every symbols.</p></li>
<li><p><code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.TARGETED</span></code>: Build an automaton similar to the original one, where a targeted state, given in parameters, will accept every symbols.</p></li>
</ul>
<p>If set to None, the default strategy is <code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.RANDOM</span></code>.</p>
</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The name of the state considered for targeted fuzzing (should be used with <code class="xref py py-attr docutils literal notranslate"><span class="pre">AutomataMutatorStrategy.TARGETED</span></code>).</p></li>
<li><p><strong>generator</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iter</span></code>, optional) – <p>The underlying generator used to produce
pseudo-random or deterministic
values.</p>
<p>Default generator is <code class="docutils literal notranslate"><span class="pre">'xorshift'</span></code>, which is
efficient to produce unique pseudo-random
numbers.</p>
</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – <p>An integer used to initialize the underlying
generator.</p>
<p>If None, the default value will be set to <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mutator.SEED_DEFAULT</span></code>. The <code class="xref py py-attr docutils literal notranslate"><span class="pre">Mutator.SEED_DEFAULT</span></code> constant is initialized from the configuration variable <code class="xref py py-attr docutils literal notranslate"><span class="pre">Conf.seed</span></code> from the Netzob API <code class="xref py py-class docutils literal notranslate"><span class="pre">Conf</span></code> class.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The mutated automata.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata" title="netzob.Model.Grammar.Automata.Automata"><code class="xref py py-class docutils literal notranslate"><span class="pre">Automata</span></code></a></p>
</dd>
</dl>
<p><strong>Catching abnormal responses from the remote target</strong></p>
<p>By default, the state machine is configured so that the
reception of abnormal messages from the remote peer will
terminate the visit loop of the automaton from the current
actor. When applying fuzzing, this behavior could be annoying
as it will quickly stop the fuzzing session as soon as a
non-legitimate response is received. In order to catch this
kind of responses and adapt the current actor behavior, it is
recommended to set the following callbacks on the automaton:</p>
<ul class="simple">
<li><p><a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata.set_cbk_read_symbol_timeout" title="netzob.Model.Grammar.Automata.Automata.set_cbk_read_symbol_timeout"><code class="xref py py-attr docutils literal notranslate"><span class="pre">set_cbk_read_symbol_timeout</span></code></a></p></li>
<li><p><a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata.set_cbk_read_unexpected_symbol" title="netzob.Model.Grammar.Automata.Automata.set_cbk_read_unexpected_symbol"><code class="xref py py-attr docutils literal notranslate"><span class="pre">set_cbk_read_unexpected_symbol</span></code></a></p></li>
<li><p><a class="reference internal" href="statemachinespec.html#netzob.Model.Grammar.Automata.Automata.set_cbk_read_unknown_symbol" title="netzob.Model.Grammar.Automata.Automata.set_cbk_read_unknown_symbol"><code class="xref py py-attr docutils literal notranslate"><span class="pre">set_cbk_read_unknown_symbol</span></code></a></p></li>
</ul>
<p>The following example shows how to specify a global behavior,
on all states and transitions, in order to catch reception of
unexpected symbols (i.e. symbols that are known but not
expected at this state/transition) and unknown messages
(i.e. messages that cannot be abstracted to a symbol).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># First we create the symbols</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello1&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello1&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbol2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hello2&quot;</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="n">Field</span><span class="p">(</span><span class="s2">&quot;hello2&quot;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbolList</span> <span class="o">=</span> <span class="p">[</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">symbol2</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_error_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Error state&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol2</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition1</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_error_state</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_closeTransition2</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">bob_s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">bob_s3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">bob_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_method</span><span class="p">(</span><span class="n">current_state</span><span class="p">,</span> <span class="n">current_transition</span><span class="p">,</span> <span class="n">received_symbol</span><span class="p">,</span> <span class="n">received_message</span><span class="p">,</span> <span class="n">received_structure</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">bob_error_state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span><span class="o">.</span><span class="n">set_cbk_read_unexpected_symbol</span><span class="p">(</span><span class="n">cbk_method</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_automata</span><span class="o">.</span><span class="n">set_cbk_read_unknown_symbol</span><span class="p">(</span><span class="n">cbk_method</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">bob_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S1            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | T1 (Hello1;{Hello2})</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S3            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;S2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_mainTransition</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">inputSymbol</span><span class="o">=</span><span class="n">symbol1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">symbol1</span><span class="p">],</span>
<span class="gp">... </span>                                  <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_closeTransition</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbolList</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#=========================#</span>
<span class="go">H           S0            H</span>
<span class="go">#=========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+   T1 (Hello1;{Hello1})</span>
<span class="go">|                         | -----------------------+</span>
<span class="go">|           S1            |                        |</span>
<span class="go">|                         | &lt;----------------------+</span>
<span class="go">+-------------------------+</span>
<span class="go">  |</span>
<span class="go">  | CloseChannelTransition</span>
<span class="go">  v</span>
<span class="go">+-------------------------+</span>
<span class="go">|           S2            |</span>
<span class="go">+-------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Bob actor (a client)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">bob_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Bob&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice actor (a server)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Alice&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Bob&#39; (initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;T1&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, sending input symbol (&#39;Hello1&#39;)</span>
<span class="go">  [+]   During transition &#39;T1&#39;, receiving unexpected symbol triggered a callback that lead to state &#39;Error state&#39;</span>
<span class="go">  [+] At state &#39;Error state&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Close&#39; (close channel)</span>
<span class="go">  [+]   Transition &#39;Close&#39; lead to state &#39;S3&#39;</span>
<span class="go">  [+] At state &#39;S3&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Alice&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;S0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Hello1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Hello1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;S1&#39;</span>
<span class="go">  [+] At state &#39;S1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
<p><strong>Basic example of automata fuzzing</strong></p>
<p>Mutators may be used in order to create fuzzed/mutated automaton.</p>
<p>The following code shows the creation of the new automaton with
random transitions between the existing states:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">nbChars</span><span class="o">=</span><span class="mi">3</span><span class="p">))],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sym1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym2</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">String</span><span class="p">(</span><span class="n">nbChars</span><span class="o">=</span><span class="mi">5</span><span class="p">))],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sym2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym1</span><span class="p">,</span> <span class="n">sym2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym2</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s4</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t4&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">                                 #========================#</span>
<span class="go">                                 H           s0           H</span>
<span class="go">                                 #========================#</span>
<span class="go">                                   |</span>
<span class="go">                                   | OpenChannelTransition</span>
<span class="go">                                   v</span>
<span class="go">                                 +------------------------+   t1 (Sym1;{Sym1})</span>
<span class="go">                                 |                        | -------------------+</span>
<span class="go">                                 |           s1           |                    |</span>
<span class="go">                                 |                        | &lt;------------------+</span>
<span class="go">                                 +------------------------+</span>
<span class="go">                                   |</span>
<span class="go">                                   | t2 (Sym2;{Sym2})</span>
<span class="go">                                   v</span>
<span class="go">+----+  CloseChannelTransition   +------------------------+</span>
<span class="go">| s4 | &lt;------------------------ |           s2           |</span>
<span class="go">+----+                           +------------------------+</span>
<span class="go">                                   |</span>
<span class="go">                                   | t3 (Sym1;{Sym1})</span>
<span class="go">                                   v</span>
<span class="go">                                 +------------------------+</span>
<span class="go">                                 |           s3           |</span>
<span class="go">                                 +------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a random automaton</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mutatedAutomata</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">mutate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii_2</span> <span class="o">=</span> <span class="n">mutatedAutomata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii_2</span><span class="p">)</span>
<span class="go">#========================#</span>
<span class="go">H           s0           H</span>
<span class="go">#========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+----------------------------------------------------------------------------------------+   t1 (Sym1;{Sym1})</span>
<span class="go">|                                                                                        | -------------------+</span>
<span class="go">|                                           s1                                           |                    |</span>
<span class="go">|                                                                                        | &lt;------------------+</span>
<span class="go">+----------------------------------------------------------------------------------------+</span>
<span class="go">  |                         ^                               ^</span>
<span class="go">  | t2 (Sym2;{Sym2})        | t_random (Sym1;{Sym1,Sym2})   | t_random (Sym2;{Sym1,Sym2})</span>
<span class="go">  v                         |                               |</span>
<span class="go">+----------------------------------------------------------------------------------------+</span>
<span class="go">|                                           s2                                           |</span>
<span class="go">+----------------------------------------------------------------------------------------+</span>
<span class="go">  |                                                         |</span>
<span class="go">  | t3 (Sym1;{Sym1})                                        | CloseChannelTransition</span>
<span class="go">  v                                                         v</span>
<span class="go">+------------------------+                                +------------------------------+</span>
<span class="go">|           s3           |                                |              s4              |</span>
<span class="go">+------------------------+                                +------------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate a full automaton</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mutatedAutomata</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">AutomataMutatorStrategy</span><span class="o">.</span><span class="n">FULL</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The ASCII representation is not displayed as it is too big</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate an automaton with one main state</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mutatedAutomata</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">AutomataMutatorStrategy</span><span class="o">.</span><span class="n">ONESTATE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii_2</span> <span class="o">=</span> <span class="n">mutatedAutomata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii_2</span><span class="p">)</span>
<span class="go">                                  #========================#</span>
<span class="go">                                  H     Initial state      H</span>
<span class="go">                                  #========================#</span>
<span class="go">                                    |</span>
<span class="go">                                    | OpenChannelTransition</span>
<span class="go">                                    v</span>
<span class="go">    t_random (Sym2;{Sym1,Sym2})   +------------------------+   t_random (Sym1;{Sym1,Sym2})</span>
<span class="go">  +------------------------------ |                        | ------------------------------+</span>
<span class="go">  |                               |       Main state       |                               |</span>
<span class="go">  +-----------------------------&gt; |                        | &lt;-----------------------------+</span>
<span class="go">                                  +------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Generate an automaton with targeted fuzzing on one specific state</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mutatedAutomata</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">AutomataMutatorStrategy</span><span class="o">.</span><span class="n">TARGETED</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">s2</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii_2</span> <span class="o">=</span> <span class="n">mutatedAutomata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii_2</span><span class="p">)</span>
<span class="go">                                  #========================#</span>
<span class="go">                                  H           s0           H</span>
<span class="go">                                  #========================#</span>
<span class="go">                                    |</span>
<span class="go">                                    | OpenChannelTransition</span>
<span class="go">                                    v</span>
<span class="go">                                  +------------------------+</span>
<span class="go">                                  |           s1           |</span>
<span class="go">                                  +------------------------+</span>
<span class="go">                                    |</span>
<span class="go">                                    | t2 (Sym2;{Sym2})</span>
<span class="go">                                    v</span>
<span class="go">    t_random (Sym2;{Sym1,Sym2})   +------------------------+   t_random (Sym1;{Sym1,Sym2})</span>
<span class="go">  +------------------------------ |                        | ------------------------------+</span>
<span class="go">  |                               |           s2           |                               |</span>
<span class="go">  +-----------------------------&gt; |                        | &lt;-----------------------------+</span>
<span class="go">                                  +------------------------+</span>
</pre></div>
</div>
<p><strong>Combining message formats and automata fuzzing</strong></p>
<p>By combining message formats and automata fuzzing, it is possible
to fuzz specific message formats at specific states in the
automaton.</p>
<p>The following code shows the creation of a mutated automaton
with targeted automaton mutations at state ‘s6’, and with a
precision concerning the state at which fuzzing of message
formats will be performed. Here, the message format fuzzing
only applies at state ‘s6’. An actor is also created to
simulate a target.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">netzob.all</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym1</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">([</span><span class="n">Field</span><span class="p">(</span><span class="n">uint16</span><span class="p">())],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Sym1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">sym1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s2</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s3</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s4</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s5</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s6</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s6&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s7</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s7&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t0</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t3</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s3</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t3&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t4</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s2</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s4</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t4&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t5</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s4</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s6</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t6</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s3</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s5</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t6&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t7</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s5</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s6</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t7&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t8</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s6</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s6</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t8&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t9</span> <span class="o">=</span> <span class="n">CloseChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">s6</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">s7</span><span class="p">,</span>
<span class="gp">... </span>                            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;t9&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">s0</span><span class="p">,</span> <span class="n">symbols</span><span class="o">=</span><span class="n">symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">                           #=========================#</span>
<span class="go">                           H           s0            H</span>
<span class="go">                           #=========================#</span>
<span class="go">                             |</span>
<span class="go">                             | OpenChannelTransition</span>
<span class="go">                             v</span>
<span class="go">                           +-------------------------+   t1 (Sym1;{Sym1})</span>
<span class="go">                           |                         | -------------------+</span>
<span class="go">                           |           s1            |                    |</span>
<span class="go">                           |                         | &lt;------------------+</span>
<span class="go">                           +-------------------------+</span>
<span class="go">                             |</span>
<span class="go">                             | t2 (Sym1;{Sym1})</span>
<span class="go">                             v</span>
<span class="go">+----+  t4 (Sym1;{Sym1})   +-------------------------+</span>
<span class="go">| s4 | &lt;------------------ |           s2            |</span>
<span class="go">+----+                     +-------------------------+</span>
<span class="go">  |                          |</span>
<span class="go">  |                          | t3 (Sym1;{Sym1})</span>
<span class="go">  |                          v</span>
<span class="go">  |                        +-------------------------+</span>
<span class="go">  |                        |           s3            |</span>
<span class="go">  |                        +-------------------------+</span>
<span class="go">  |                          |</span>
<span class="go">  |                          | t6 (Sym1;{Sym1})</span>
<span class="go">  |                          v</span>
<span class="go">  |                        +-------------------------+</span>
<span class="go">  |                        |           s5            |</span>
<span class="go">  |                        +-------------------------+</span>
<span class="go">  |                          |</span>
<span class="go">  |                          | t7 (Sym1;{Sym1})</span>
<span class="go">  |                          v</span>
<span class="go">  |                        +-------------------------+   t8 (Sym1;{Sym1})</span>
<span class="go">  |                        |                         | -------------------+</span>
<span class="go">  |    t5 (Sym1;{Sym1})    |           s6            |                    |</span>
<span class="go">  +----------------------&gt; |                         | &lt;------------------+</span>
<span class="go">                           +-------------------------+</span>
<span class="go">                             |</span>
<span class="go">                             | CloseChannelTransition</span>
<span class="go">                             v</span>
<span class="go">                           +-------------------------+</span>
<span class="go">                           |           s7            |</span>
<span class="go">                           +-------------------------+</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a mutated automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mutatedAutomata</span> <span class="o">=</span> <span class="n">automata</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">AutomataMutatorStrategy</span><span class="o">.</span><span class="n">TARGETED</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">s6</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">mutatedAutomata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">#========================#</span>
<span class="go">H           s0           H</span>
<span class="go">#========================#</span>
<span class="go">  |</span>
<span class="go">  | OpenChannelTransition</span>
<span class="go">  v</span>
<span class="go">+------------------------+</span>
<span class="go">|           s1           |</span>
<span class="go">+------------------------+</span>
<span class="go">  |</span>
<span class="go">  | t2 (Sym1;{Sym1})</span>
<span class="go">  v</span>
<span class="go">+------------------------+</span>
<span class="go">|           s2           |</span>
<span class="go">+------------------------+</span>
<span class="go">  |</span>
<span class="go">  | t4 (Sym1;{Sym1})</span>
<span class="go">  v</span>
<span class="go">+------------------------+</span>
<span class="go">|           s4           |</span>
<span class="go">+------------------------+</span>
<span class="go">  |</span>
<span class="go">  | t5 (Sym1;{Sym1})</span>
<span class="go">  v</span>
<span class="go">+------------------------+   t_random (Sym1;{Sym1})</span>
<span class="go">|                        | -------------------------+</span>
<span class="go">|           s6           |                          |</span>
<span class="go">|                        | &lt;------------------------+</span>
<span class="go">+------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define fuzzing configuration</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span> <span class="o">=</span> <span class="n">Preset</span><span class="p">(</span><span class="n">sym1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preset_symbol1</span><span class="o">.</span><span class="n">fuzz</span><span class="p">(</span><span class="n">sym1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of an automaton visitor/actor and a channel on which to emit the fuzzed symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_channel</span> <span class="o">=</span> <span class="n">UDPClient</span><span class="p">(</span><span class="n">remoteIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">remotePort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">mutatedAutomata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">bob_channel</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Fuzzer&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span><span class="o">.</span><span class="n">fuzzing_presets</span> <span class="o">=</span> <span class="p">[</span><span class="n">preset_symbol1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span><span class="o">.</span><span class="n">fuzzing_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">s6</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span><span class="o">.</span><span class="n">nbMaxTransitions</span> <span class="o">=</span> <span class="mi">7</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create Alice&#39;s automaton</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s0</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_s1</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;s1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_openTransition</span> <span class="o">=</span> <span class="n">OpenChannelTransition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Open&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition1</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym1</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym1</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_transition2</span> <span class="o">=</span> <span class="n">Transition</span><span class="p">(</span><span class="n">startState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span> <span class="n">endState</span><span class="o">=</span><span class="n">alice_s1</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">inputSymbol</span><span class="o">=</span><span class="n">sym2</span><span class="p">,</span> <span class="n">outputSymbols</span><span class="o">=</span><span class="p">[</span><span class="n">sym2</span><span class="p">],</span>
<span class="gp">... </span>                               <span class="n">name</span><span class="o">=</span><span class="s2">&quot;T2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span> <span class="o">=</span> <span class="n">Automata</span><span class="p">(</span><span class="n">alice_s0</span><span class="p">,</span> <span class="n">symbols</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">automata_ascii</span> <span class="o">=</span> <span class="n">alice_automata</span><span class="o">.</span><span class="n">generateASCII</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">automata_ascii</span><span class="p">)</span>
<span class="go">                       #========================#</span>
<span class="go">                       H           s0           H</span>
<span class="go">                       #========================#</span>
<span class="go">                         |</span>
<span class="go">                         | OpenChannelTransition</span>
<span class="go">                         v</span>
<span class="go">    T2 (Sym2;{Sym2})   +------------------------+   T1 (Sym1;{Sym1})</span>
<span class="go">  +------------------- |                        | -------------------+</span>
<span class="go">  |                    |           s1           |                    |</span>
<span class="go">  +------------------&gt; |                        | &lt;------------------+</span>
<span class="go">                       +------------------------+</span>

<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of an automaton visitor/actor and a channel on which to receive the fuzzing traffic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_channel</span> <span class="o">=</span> <span class="n">UDPServer</span><span class="p">(</span><span class="n">localIP</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">localPort</span><span class="o">=</span><span class="mi">8887</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creation of a callback function that returns a new transition</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">cbk_modifyTransition</span><span class="p">(</span><span class="n">availableTransitions</span><span class="p">,</span> <span class="n">nextTransition</span><span class="p">,</span> <span class="n">current_state</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_sent_symbol</span><span class="p">,</span> <span class="n">last_sent_message</span><span class="p">,</span> <span class="n">last_sent_structure</span><span class="p">,</span>
<span class="gp">... </span>                         <span class="n">last_received_symbol</span><span class="p">,</span> <span class="n">last_received_message</span><span class="p">,</span> <span class="n">last_received_structure</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">nextTransition</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">alice_transition2</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">nextTransition</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_automata</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="s1">&#39;s1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">add_cbk_modify_transition</span><span class="p">(</span><span class="n">cbk_modifyTransition</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_actor</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">(</span><span class="n">automata</span><span class="o">=</span><span class="n">alice_automata</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">alice_channel</span><span class="p">,</span> <span class="n">initiator</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We start the targeted actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_actor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We start the visitor, thus the fuzzing of message formats will be applied when specific states are reached</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob_actor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alice_actor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bob_actor</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Fuzzer&#39; (initiator):</span>
<span class="go">  [+] At state &#39;s0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t0&#39; (open channel)</span>
<span class="go">  [+]   Transition &#39;t0&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t2&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t2&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t2&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t2&#39; lead to state &#39;s2&#39;</span>
<span class="go">  [+] At state &#39;s2&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t4&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t4&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t4&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t4&#39; lead to state &#39;s4&#39;</span>
<span class="go">  [+] At state &#39;s4&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t5&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t5&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t5&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t5&#39; lead to state &#39;s6&#39;</span>
<span class="go">  [+] At state &#39;s6&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t_random&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, fuzzing activated</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t_random&#39; lead to state &#39;s6&#39;</span>
<span class="go">  [+] At state &#39;s6&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t_random&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, fuzzing activated</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t_random&#39; lead to state &#39;s6&#39;</span>
<span class="go">  [+] At state &#39;s6&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;t_random&#39; (initiator)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, sending input symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, fuzzing activated</span>
<span class="go">  [+]   During transition &#39;t_random&#39;, receiving expected output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;t_random&#39; lead to state &#39;s6&#39;</span>
<span class="go">  [+] At state &#39;s6&#39;, we reached the max number of transitions (7), so we stop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">alice_actor</span><span class="o">.</span><span class="n">generateLog</span><span class="p">())</span>
<span class="go">Activity log for actor &#39;Target&#39; (not initiator):</span>
<span class="go">  [+] At state &#39;s0&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Picking transition &#39;Open&#39; (open channel)</span>
<span class="go">  [+]   Going to execute transition &#39;Open&#39;</span>
<span class="go">  [+]   Transition &#39;Open&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
<span class="go">  [+]   Input symbol &#39;Sym1&#39; corresponds to transition &#39;T1&#39;</span>
<span class="go">  [+]   Changing transition to &#39;T1&#39; (not initiator), through callback</span>
<span class="go">  [+]   During transition &#39;T1&#39;, choosing an output symbol (&#39;Sym1&#39;)</span>
<span class="go">  [+]   Transition &#39;T1&#39; lead to state &#39;s1&#39;</span>
<span class="go">  [+] At state &#39;s1&#39;</span>
<span class="go">  [+]   Randomly choosing a transition to execute or to wait for an input symbol</span>
<span class="go">  [+]   Waiting for an input symbol to decide the transition (not initiator)</span>
</pre></div>
</div>
</dd></dl>

</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="fuzzing.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Fuzzing Message Format</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
      &copy; Copyright 2011-2022, Frédéric Guihéry, Georges Bossert.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>